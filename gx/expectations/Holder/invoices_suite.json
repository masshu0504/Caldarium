{
  "data_asset_type": null,
  "expectation_suite_name": "invoices_suite",
  "ge_cloud_id": null,
  "expectations": [
    {"expectation_type": "expect_column_to_exist", "kwargs": {"column": "invoice_number"}},
    {"expectation_type": "expect_column_to_exist", "kwargs": {"column": "invoice_date"}},
    {"expectation_type": "expect_column_to_exist", "kwargs": {"column": "due_date"}},
    {"expectation_type": "expect_column_to_exist", "kwargs": {"column": "patient_name"}},
    {"expectation_type": "expect_column_to_exist", "kwargs": {"column": "subtotal_amount"}},
    {"expectation_type": "expect_column_to_exist", "kwargs": {"column": "total_amount"}},
    {"expectation_type": "expect_column_to_exist", "kwargs": {"column": "line_items"}},

    {"expectation_type": "expect_table_columns_to_match_set",
      "kwargs": {
        "column_set": [
          "invoice_number","invoice_date","due_date","patient_name",
          "patient_id","patient_age","patient_address","patient_phone","patient_email",
          "admission_date","discharge_date",
          "subtotal_amount","discount_amount","total_amount",
          "provider_name","bed_id","line_items"
        ],
        "exact_match": false
      }
    },

    {"expectation_type": "expect_column_values_to_not_be_null", "kwargs": {"column": "invoice_number"}},
    {"expectation_type": "expect_column_values_to_be_of_type", "kwargs": {"column": "invoice_number", "type_": "object"}},

    {"expectation_type": "expect_column_values_to_not_be_null", "kwargs": {"column": "invoice_date"}},
    {"expectation_type": "expect_column_values_to_match_regex", "kwargs": {"column": "invoice_date", "regex": "^\\d{4}-\\d{2}-\\d{2}$"}},

    {"expectation_type": "expect_column_values_to_not_be_null", "kwargs": {"column": "due_date"}},
    {"expectation_type": "expect_column_values_to_match_regex", "kwargs": {"column": "due_date", "regex": "^\\d{4}-\\d{2}-\\d{2}$"}},

    {"expectation_type": "expect_column_values_to_not_be_null", "kwargs": {"column": "patient_name"}},
    {"expectation_type": "expect_column_values_to_be_of_type", "kwargs": {"column": "patient_name", "type_": "object"}},

    {"expectation_type": "expect_column_values_to_not_be_null", "kwargs": {"column": "subtotal_amount"}},
    {"expectation_type": "expect_column_values_to_be_of_type", "kwargs": {"column": "subtotal_amount", "type_": "float"}},
    {"expectation_type": "expect_column_min_to_be_between", "kwargs": {"column": "subtotal_amount", "min_value": 0, "mostly": 1.0}},

    {"expectation_type": "expect_column_values_to_not_be_null", "kwargs": {"column": "total_amount"}},
    {"expectation_type": "expect_column_values_to_be_of_type", "kwargs": {"column": "total_amount", "type_": "float"}},
    {"expectation_type": "expect_column_min_to_be_between", "kwargs": {"column": "total_amount", "min_value": 0, "mostly": 1.0}},

    {"expectation_type": "expect_column_values_to_be_of_type", "kwargs": {"column": "patient_id", "type_": "object"}, "meta": {"nullable_ok": true}},
    {"expectation_type": "expect_column_values_to_be_of_type", "kwargs": {"column": "patient_address", "type_": "object"}, "meta": {"nullable_ok": true}},
    {"expectation_type": "expect_column_values_to_be_of_type", "kwargs": {"column": "provider_name", "type_": "object"}, "meta": {"nullable_ok": true}},
    {"expectation_type": "expect_column_values_to_be_of_type", "kwargs": {"column": "bed_id", "type_": "object"}, "meta": {"nullable_ok": true}},

    {"expectation_type": "expect_column_values_to_be_of_type", "kwargs": {"column": "patient_age", "type_": "float"}, "meta": {"nullable_ok": true}},
    {"expectation_type": "expect_column_min_to_be_between", "kwargs": {"column": "patient_age", "min_value": 0}, "meta": {"nullable_ok": true}},

    {"expectation_type": "expect_column_values_to_be_of_type", "kwargs": {"column": "discount_amount", "type_": "float"}, "meta": {"nullable_ok": true}},
    {"expectation_type": "expect_column_min_to_be_between", "kwargs": {"column": "discount_amount", "min_value": 0}, "meta": {"nullable_ok": true}},

    {"expectation_type": "expect_column_values_to_match_regex", "kwargs": {"column": "patient_email", "regex": "^[^@\\s]+@[^@\\s]+\\.[^@\\s]+$"}, "meta": {"nullable_ok": true}},
    {"expectation_type": "expect_column_values_to_match_regex", "kwargs": {"column": "patient_phone", "regex": "^[0-9+()\\-\\s]{7,}$"}, "meta": {"nullable_ok": true}},

    {"expectation_type": "expect_column_values_to_match_regex", "kwargs": {"column": "admission_date", "regex": "^\\d{4}-\\d{2}-\\d{2}$"}, "meta": {"nullable_ok": true}},
    {"expectation_type": "expect_column_values_to_match_regex", "kwargs": {"column": "discharge_date", "regex": "^\\d{4}-\\d{2}-\\d{2}$"}, "meta": {"nullable_ok": true}},

    {"expectation_type": "expect_column_pair_values_A_to_be_greater_than_or_equal_to_B",
     "kwargs": {"column_A": "due_date", "column_B": "invoice_date"}},

    {"expectation_type": "expect_column_pair_values_A_to_be_greater_than_or_equal_to_B",
     "kwargs": {"column_A": "discharge_date", "column_B": "admission_date"},
     "meta": {"skip_if_null_either": true}},

    {"expectation_type": "expect_column_pair_values_A_to_be_greater_than_or_equal_to_B",
     "kwargs": {"column_A": "total_amount", "column_B": "subtotal_amount"}},

    {"expectation_type": "expect_total_equals_subtotal_minus_discount_within_tolerance",
     "kwargs": {"total": "total_amount", "subtotal": "subtotal_amount", "discount": "discount_amount", "tolerance": 0.01}},

    {"expectation_type": "expect_line_items_sum_to_equal_subtotal_within_tolerance",
     "kwargs": {"line_items": "line_items", "subtotal": "subtotal_amount", "tolerance": 0.01}},

    {"expectation_type": "expect_line_items_elements_to_have_keys",
     "kwargs": {"line_items": "line_items", "required_keys": ["description","code","amount"]}},

    {"expectation_type": "expect_line_items_amounts_to_be_nonnegative",
     "kwargs": {"line_items": "line_items"}}
  ],
  "meta": {
    "notes": {
      "content": [
        "Enforces the finalized invoice schema fields and types.",
        "Date formats must be YYYY-MM-DD. Email must be a simple RFC5322-lite regex.",
        "Custom expectations validate JSON array structure (`line_items`) and cross-field math/date rules with tolerances.",
        "If your pipeline stores `line_items` as nested JSON per row, these custom expectations operate directly on the parsed Python list/dict in each row."
      ],
      "format": "markdown"
    }
  }
}
